# 回归测试清单

## 核心功能验证 (必须全部通过)

### 1. 基于被驳回报销单创建新单
- [ ] 函数是异步的 (async function createFormFromRejected)
- [ ] 路由正确调用异步函数 (async (req, res) => { await createFormFromRejected })
- [ ] 发票字段完整复制 (5个字段)
- [ ] 附件正确复制
- [ ] 新单创建成功
- [ ] 跳转到详情页面正常

### 2. 发票字段处理
- [ ] createFormAutoGenerate包含5个发票字段
- [ ] updateForm包含5个发票字段
- [ ] 前端提交包含5个发票字段
- [ ] 前端显示发票金额输入框
- [ ] 数据库正确保存发票字段

### 3. 附件处理
- [ ] 附件上传正常
- [ ] 附件预览正常
- [ ] 附件复制路径正确
- [ ] 临时文件处理正常
- [ ] 附件删除权限正确

### 4. 权限和安全
- [ ] 删除凭证使用正确字段名 (form_id)
- [ ] 用户权限验证正常
- [ ] 创建人权限检查正常
- [ ] 状态检查正常

### 5. 前端界面
- [ ] 报销单列表显示正常
- [ ] 报销单详情显示正常
- [ ] 报销单编辑功能正常
- [ ] 按钮显示逻辑正确
- [ ] 状态显示正确

## 测试步骤

### 完整流程测试
1. 创建报销单 (包含发票字段和附件)
2. 提交报销单
3. 财务驳回报销单
4. 使用"基于此单创建新报销申请"
5. 验证新单包含完整信息
6. 编辑新单并保存
7. 提交新单

### 边界情况测试
1. 无附件的报销单复制
2. 多个附件的报销单复制
3. 大文件附件处理
4. 特殊字符发票号处理
5. 权限边界测试

